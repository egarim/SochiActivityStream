@* Messages Content Component - Conversation list UI *@
@using SocialKit.Components.ViewModels

<div class="sk-messages" style="max-width: 1200px; margin: 0 auto;">
    <div class="d-flex" style="min-height:70vh;">
        <!-- Conversation List -->
        <div class="sk-conversation-list" style="width:350px;border-right:1px solid var(--sk-border,#dee2e6);">
            <div class="p-3">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <MudText Typo="Typo.h6">Messages</MudText>
                    <div class="d-flex gap-1">
                        <MudIconButton Icon="@Icons.Material.Filled.Edit" Size="Size.Small" />
                        <CommandButton Command="@ViewModel.RefreshCommand" CssClass="btn btn-link btn-sm p-1">
                            <MudIcon Icon="@Icons.Material.Filled.Refresh" Class="@(ViewModel.RefreshCommand.IsExecuting ? "rotate-animation" : "")" />
                        </CommandButton>
                    </div>
                </div>
                <MudTextField T="string" id="message-search" Placeholder="Search messages..." Variant="Variant.Outlined" Class="mb-2" />
            </div>
            
            <div style="overflow-y:auto;">
                @if (ViewModel.IsBusy)
                {
                    @for (int i = 0; i < 5; i++)
                    {
                        <Skeleton Type="SocialKit.Components.Components.Common.SkeletonType.ConversationItem" />
                    }
                }
                else if (ViewModel.Conversations.Count == 0)
                {
                    <div class="text-center p-5">
                        <MudIcon Icon="@Icons.Material.Filled.Forum" Style="font-size:48px;" Color="Color.Default" />
                        <MudText Typo="Typo.subtitle1" Class="mt-3">No messages yet</MudText>
                        <MudText Typo="Typo.body2" Class="mud-text-secondary">Start a conversation!</MudText>
                    </div>
                }
                else
                {
                    @foreach (var conv in ViewModel.Conversations)
                    {
                        <ConversationItem 
                            Conversation="@conv"
                            CurrentUserId="@ViewModel.CurrentUserId"
                            OnClick="@(async (c) => await ViewModel.OpenConversationCommand.ExecuteAsync(c))" />
                    }
                }
            </div>
        </div>
        
        <!-- Chat Area Placeholder -->
        <div class="flex-grow-1 d-flex align-items-center justify-content-center">
            <div class="text-center mud-text-secondary">
                <MudIcon Icon="@Icons.Material.Filled.Forum" Style="font-size:64px;" />
                <MudText Typo="Typo.h6" Class="mt-3">Select a conversation</MudText>
                <MudText Typo="Typo.body2">Choose from your existing conversations or start a new one.</MudText>
            </div>
        </div>
    </div>
</div>

@code {
    [Parameter, EditorRequired] public MessagesViewModel ViewModel { get; set; } = null!;
}
